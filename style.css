// Story content
const storyContent = [
  { type: 'image', src: 'images/first_pic_togheter.jpg' },
  { type: 'text', content: "And, this begins with a single moment..." },
  { type: 'image', src: 'images/first_nightview.jpg' },
  { type: 'text', content: "You are like that moon illuminating the sky in the pitch dark night :P" },
  { type: 'image', src: 'images/first_sunrise.jpg' },
  { type: 'text', content: "One of the 'craziest' nights I had and a beautiful memory." },
  { type: 'image', src: 'images/cute_you.jpg' },
  { type: 'text', content: "Seeing you so happy to see me... I totally fell for you." },
  { type: 'image', src: 'images/us.jpg' },
  { type: 'image', src: 'images/us1.jpg' },
  { type: 'text', content: "One of the most precious memories — us." },
  { type: 'image', src: 'images/us_silly_1.jpg' },
  { type: 'image', src: 'images/we_silly.jpg' },
  { type: 'text', content: "You are so silly, really, my lovely woman. :)" }
];

let currentIndex = 0;
let isTransitioning = false; // Prevent double taps

const starter = document.getElementById('starter');
const story = document.getElementById('story');
const startButton = document.getElementById('startButton');
const mediaContainer = document.getElementById('media-container');
const storyImage = document.getElementById('story-image');
const storyText = document.getElementById('story-text');

// Show start button with delay
setTimeout(() => {
  startButton.classList.remove('hidden');
}, 2000);

// Start button event
startButton.addEventListener('click', () => {
  if (isTransitioning) return;
  isTransitioning = true;

  starter.classList.remove('active');
  setTimeout(() => {
    starter.classList.add('hidden');
    story.classList.remove('hidden');
    story.classList.add('active');
    showNext();
  }, 500);
});

// Advance on click/tap
mediaContainer.addEventListener('click', () => {
  if (isTransitioning) return;
  showNext();
});

function showNext() {
  isTransitioning = true;

  // Add vanish effect
  storyImage.classList.add('vanish');
  storyText.classList.add('vanish');

  // Wait for vanish animation
  setTimeout(() => {
    storyImage.classList.add('hidden');
    storyText.classList.add('hidden');
    storyImage.classList.remove('vanish');
    storyText.classList.remove('vanish');

    if (currentIndex >= storyContent.length) {
      mediaContainer.innerHTML = `
        <div class="end-text">
          <h2>The End ❤ :P </h2>
          <p>Thank you for being my kitty</p>
        </div>
      `;
      isTransitioning = false;
      return;
    }

    const item = storyContent[currentIndex];

    if (item.type === 'image') {
      storyImage.src = item.src;
      storyImage.classList.remove('hidden');
      setTimeout(() => {
        storyImage.classList.add('fade-in');
      }, 50);
    } else {
      storyText.textContent = item.content;
      storyText.classList.remove('hidden');
      setTimeout(() => {
        storyText.classList.add('fade-in');
      }, 50);
    }

    currentIndex++;
    isTransitioning = false;

  }, 500); // Match vanish animation duration
}
